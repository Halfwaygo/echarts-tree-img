<!DOCTYPE html>
<head>
    <meta charset="utf-8">
    <title>ECharts</title>
</head>

<style>
    body {
        background-color:  rgb(66, 66, 66);
        display: flex;
        justify-content: center;
        align-items: center;
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
    }
    #main, canvas {
        position: absolute;
        top: 0 !important;
        bottom: 0 !important;
        left: 0 !important;
        right: 0 !important;
    }
    #dialog {
        display: none;
    }
    .dialog {
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        background: none;
        align-items: center;
        justify-content: center;
        display: flex;
    }
</style>

<body>
    <!-- 为ECharts准备一个具备大小（宽高）的Dom -->
    <div id="main"></div>
    <div id="dialog">
        <div  class="dialog">
            <img src="" id="img"/>
        </div>
    </div>

    <!-- ECharts单文件引入 -->
    <script src="./echarts.min.js"></script>
  

    <script>
     // 基于准备好的dom，初始化echarts图表
     var myChart = echarts.init(document.getElementById('main'));
    let newData =
    {
            "id": 575,
            "name": "5c484739ce57d11b2562fc57",
            "symbol": "image://https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2115254197,2697414359&fm=58",
            "symbolSize": [
                48,
                48
            ],
            "children": [
                {
                    "id": 519,
                    "name": "5c484739ce57d11b2562fc58",
                    "intimacy": "1",
                    "symbol": "image://https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2115254197,2697414359&fm=58",
                    "symbolSize": [
                        48,
                        48
                    ],
                    "children": [
                        {
                            "id": 584,
                            "name": "5c405900a97ba663a029e73f",
                            "intimacy": "3",
                            "symbol": "image://https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2115254197,2697414359&fm=58",
                            "symbolSize": [
                                48,
                                48
                            ],
                            "children": [
                                {
                                    "id": 433,
                                    "name": "5c405900a97ba663a029e743",
                                    "intimacy": "3",
                                    "symbol": "image://https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2115254197,2697414359&fm=58",
                                    "symbolSize": [
                                        48,
                                        48
                                    ],
                                    "children": []
                                },
                                {
                                    "id": 441,
                                    "name": "5c405900a97ba663a029e741",
                                    "intimacy": "3",
                                    "symbol": "image://https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2115254197,2697414359&fm=58",
                                    "symbolSize": [
                                        48,
                                        48
                                    ],
                                    "children": []
                                },
                                {
                                    "id": 136,
                                    "name": "5c405904a97ba663a029e75a",
                                    "intimacy": "3",
                                    "symbol": "image://https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2115254197,2697414359&fm=58",
                                    "symbolSize": [
                                        48,
                                        48
                                    ],
                                    "children": []
                                }
                            ]
                        },
                        {
                            "id": 481,
                            "name": "5c402e82a97ba613948acf8d",
                            "intimacy": "6",
                            "symbol": "image://https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2115254197,2697414359&fm=58",
                            "symbolSize": [
                                48,
                                48
                            ],
                            "children": [
                                {
                                    "id": 370,
                                    "name": "5c402906a97ba611d75481c5",
                                    "intimacy": "13",
                                    "symbol": "image://https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2115254197,2697414359&fm=58",
                                    "symbolSize": [
                                        48,
                                        48
                                    ],
                                    "children": []
                                },
                                {
                                    "id": 470,
                                    "name": "5c40298ea97ba613948ac448",
                                    "intimacy": "14",
                                    "symbol": "image://https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2115254197,2697414359&fm=58",
                                    "symbolSize": [
                                        48,
                                        48
                                    ],
                                    "children": []
                                },
                                {
                                    "id": 544,
                                    "name": "5c402939a97ba613948ac335",
                                    "intimacy": "12",
                                    "symbol": "image://https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2115254197,2697414359&fm=58",
                                    "symbolSize": [
                                        48,
                                        48
                                    ],
                                    "children": []
                                }
                            ]
                        },
                        {
                            "id": 555,
                            "name": "5c3761ea4f8b57142130ac4f",
                            "intimacy": "3",
                            "symbol": "image://https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2115254197,2697414359&fm=58",
                            "symbolSize": [
                                48,
                                48
                            ],
                            "children": [
                                {
                                    "id": 448,
                                    "name": "5c3f3728a97ba62d7020f284",
                                    "intimacy": "6",
                                    "symbol": "image://https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2115254197,2697414359&fm=58",
                                    "symbolSize": [
                                        48,
                                        48
                                    ],
                                    "children": []
                                },
                                {
                                    "id": 577,
                                    "name": "5c3741754f8b570014751411",
                                    "intimacy": "8",
                                    "symbol": "image://https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2115254197,2697414359&fm=58",
                                    "symbolSize": [
                                        48,
                                        48
                                    ],
                                    "children": []
                                },
                                {
                                    "id": 493,
                                    "name": "5c3761e64f8b57142130ac48",
                                    "intimacy": "5",
                                    "symbol": "image://https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2115254197,2697414359&fm=58",
                                    "symbolSize": [
                                        48,
                                        48
                                    ],
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": 576,
                    "name": "5c484731ce57d11b2562fc52",
                    "intimacy": "1",
                    "symbol": "image://https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2115254197,2697414359&fm=58",
                    "symbolSize": [
                        48,
                        48
                    ],
                    "children": [
                        {
                            "id": 415,
                            "name": "5c484735ce57d11b2562fc55",
                            "intimacy": "1",
                            "symbol": "image://https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2115254197,2697414359&fm=58",
                            "symbolSize": [
                                48,
                                48
                            ],
                            "children": []
                        },
                        {
                            "id": 492,
                            "name": "5c48472cce57d11b2562fc51",
                            "intimacy": "1",
                            "symbol": "image://https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2115254197,2697414359&fm=58",
                            "symbolSize": [
                                48,
                                48
                            ],
                            "children": []
                        }
                    ]
                }
            ]
        }

    function changeData(node) {
        console.log(node)
        if(node.hasOwnProperty('intimacy')) {
            var newnode = JSON.parse(JSON.stringify(node))
            node.name = newnode.intimacy
            node.symbolSize = [30, 30]
            node.children = [{
                name: newnode.name,
                symbol: newnode.symbol,
                symbolSize: newnode.symbolSize,
                children: newnode.children
            }]
            delete node.intimacy
            delete node.symbol
        }
        if (node.hasOwnProperty('children')) {
            node.children.forEach(function(item, index) {
                changeData(item);
            });
        }
    }
    changeData(newData)
    showEcharts([newData])
    function showEcharts(newData1) {
      console.log(JSON.stringify(newData1))
      var option = {
            title : {
                text: '',
                subtext: ''
            },
            tooltip : {
                show:false,
                trigger: 'item',
                formatter: "{b}: {c}"
            },
            toolbox: {
                show : false
            },
            calculable : false,
            series : [
                {
                    name:'树图',
                    type:'tree',
                    roam: true,
                    orient: 'horizontal',  // vertical horizontal
                    initialTreeDepth: -1,
                    itemStyle: {
                        normal: {
                            label: {
                                show: true,
                                position: 'inside',
                                textStyle: {
                                    color: '#000',
                                    fontSize: 14,
                                    align:'center',
                                verticalAlign:'middle'
                                }
                            },
                            lineStyle: {
                                color: '#ccc',
                                width: 1,
                                type: 'solid' // 'curve'|'broken'|'solid'|'dotted'|'dashed'
                            },
                            color: '#fff',
                            borderColor: '#fff'
                        }
                    },
                    data: newData1,
                    left: '12%',
                    right: '5%',
                    top: '7%',
                    bottom: '7%',
                }
            ]
        };
        // 为echarts对象加载数据
        myChart.hideLoading(option);
        myChart.setOption(option);
        myChart.on("dblclick", clickFun);
     }
     //关键点！
    function clickFun(param) {
        console.log(param)
        // if (typeof param.seriesIndex == 'undefined') {
        //     return;
        // }
        if (param.type == 'dblclick') {
            var imgurl = param.data.symbol.split('image://')[1];
            document.getElementById('img').src = imgurl
            document.getElementById('dialog').style.display = 'block'

        }
    }
    document.getElementById("dialog").onclick = function() {
        document.getElementById('dialog').style.display = 'none';
    }
    </script>
</body>
